<div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow">
  <h1 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">Assign Permissions to <%= @role.name %></h1>
  
  <div class="mb-4">
    <p class="text-sm text-gray-700 dark:text-gray-300 mb-2">
      Role permissions determine what actions users with this role can perform in the system.
    </p>
  </div>
  
  <%= form_with(url: assign_permissions_hub_admin_role_path(@role), method: :post, class: "space-y-6") do |form| %>
    <div class="text-sm text-gray-700 dark:text-gray-300 mb-2">Permissions are grouped by namespace and controller.</div>
    
    <% @permissions_by_namespace.each do |namespace, controllers| %>
      <div class="mb-8">
        <h2 class="text-lg font-semibold mb-2 text-gray-900 dark:text-white border-b pb-2"><%= namespace.present? ? namespace : 'Global' %></h2>
        
        <div class="pl-4">
          <% controllers.each do |controller, permissions| %>
            <div class="mb-4">
              <h3 class="text-md font-medium mb-2 text-gray-800 dark:text-gray-200"><%= controller.humanize %></h3>
              
              <div class="pl-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2">
                <% permissions.each do |permission| %>
                  <div class="flex items-center">
                    <input 
                      id="permission-<%= permission.id %>" 
                      type="checkbox" 
                      name="role[permission_ids][]" 
                      value="<%= permission.id %>" 
                      <%= 'checked' if @assigned_permission_ids.include?(permission.id) %>
                      class="w-4 h-4 text-green-700 bg-gray-100 border-gray-300 rounded focus:ring-green-700 dark:focus:ring-green-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"
                    >
                    <label for="permission-<%= permission.id %>" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                      <%= permission.action.humanize %>
                    </label>
                  </div>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
    
    <div class="pt-4 border-t border-gray-200 dark:border-gray-700">
      <div class="flex items-center justify-between">
        <div class="w-full lg:w-1/2">
          <label for="expires_at" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Expiration (Optional)</label>
          <%= form.date_field :expires_at, class: "bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-green-700 focus:border-green-700 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-green-700 dark:focus:border-green-700" %>
        </div>
      </div>
    </div>
    
    <div class="flex justify-end space-x-4">
      <%= link_to 'Cancel', hub_admin_role_path(@role), class: "text-sm py-2.5 px-5 text-gray-900 bg-white border border-gray-300 hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-green-300 rounded-lg text-center font-medium dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-green-800" %>
      
      <%= form.submit 'Save Permissions', class: "text-sm py-2.5 px-5 text-white bg-[#1C3835] hover:bg-[#152A27] focus:ring-4 focus:outline-none focus:ring-green-300 rounded-lg text-center font-medium dark:bg-[#1C3835] dark:hover:bg-[#152A27] dark:focus:ring-green-800" %>
    </div>
  <% end %>
</div>
