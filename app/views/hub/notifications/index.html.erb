<div class="p-4 max-w-4xl mx-auto">
  <div class="mb-8">
    <h1 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">Notifications</h1>
    <p class="text-gray-500 dark:text-gray-400">This page shows all your notifications and their status.</p>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
    <!-- Stats Cards -->
    <div class="p-4 bg-white rounded-lg shadow dark:bg-gray-800">
      <div class="flex items-center justify-between">
        <h2 class="text-lg font-semibold text-gray-900 dark:text-white">Unread</h2>
        <span class="text-xl font-bold text-primary-600 dark:text-primary-500"><%= @unread_count %></span>
      </div>
    </div>
    
    <div class="p-4 bg-white rounded-lg shadow dark:bg-gray-800">
      <div class="flex items-center justify-between">
        <h2 class="text-lg font-semibold text-gray-900 dark:text-white">Total</h2>
        <span class="text-xl font-bold text-gray-900 dark:text-white"><%= @total_count %></span>
      </div>
    </div>
    
    <div class="p-4 bg-white rounded-lg shadow dark:bg-gray-800">
      <div class="flex items-center justify-between">
        <h2 class="text-lg font-semibold text-gray-900 dark:text-white">Read Rate</h2>
        <span class="text-xl font-bold text-indigo-600 dark:text-indigo-500"><%= @read_rate %>%</span>
      </div>
    </div>
  </div>
  
  <% if policy(:hub_notification).create? %>
  <!-- Admin Only: Create Notification Form -->
  <div class="mb-8 p-6 bg-white rounded-lg shadow dark:bg-gray-800">
    <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Send Notification to User</h2>
    
    <%= form_with url: hub_notifications_path, method: :post, class: "space-y-4" do |f| %>
      <div>
        <%= f.label :user_id, 'User', class: "block mb-2 text-sm font-medium text-gray-900 dark:text-white" %>
        <%= f.select :user_id, 
            options_from_collection_for_select(Hub::Admin::User.order(:email_address), :id, :email_address),
            { include_blank: 'Select a user' },
            { class: "bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white" } 
        %>
      </div>
      
      <div>
        <%= f.label :message, class: "block mb-2 text-sm font-medium text-gray-900 dark:text-white" %>
        <%= f.text_area :message, rows: 3, class: "block p-2.5 w-full text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white", placeholder: "Enter notification message..." %>
      </div>
      
      <div>
        <%= f.label :notification_type, class: "block mb-2 text-sm font-medium text-gray-900 dark:text-white" %>
        <%= f.select :notification_type, 
            options_for_select([
              ['Info', 'info'],
              ['Success', 'success'],
              ['Warning', 'warning'],
              ['Error', 'error']
            ], 'info'),
            {},
            { class: "bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white" } 
        %>
      </div>
      
      <div>
        <%= f.label :url, 'Link URL (optional)', class: "block mb-2 text-sm font-medium text-gray-900 dark:text-white" %>
        <%= f.text_field :url, class: "bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white", placeholder: "/hub" %>
      </div>
      
      <div class="flex items-center">
        <%= f.submit "Send Notification", class: "text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800" %>
      </div>
    <% end %>
  </div>
  <% end %>
  
  <!-- Notifications List -->
  <div class="bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden">
    <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
      <h2 class="text-xl font-semibold text-gray-900 dark:text-white">All Notifications</h2>
      
      <% if @notifications.any? %>
        <%= button_to mark_all_as_read_hub_notifications_path, method: :post, class: "text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800" do %>
          Mark All as Read
        <% end %>
      <% end %>
    </div>
    
    <div id="notifications-container">
      <%= render partial: "hub/notifications/items", locals: { notifications: @notifications } %>
    </div>
  </div>
</div>

<div id="toast-container" data-controller="toasts" data-toasts-duration-value="5000" class="fixed top-4 right-4 z-50 flex flex-col items-end gap-2 max-w-md">
  <!-- Toast notifications will be inserted here -->
</div>
